<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
  </head>
  <body>
    <script>
      /**
       * 在過去我們有很多 加總 陣列裡所有值的題目
       * 在過去我們會使用 for 然後把項目一一加到 sum 這個變數
       */
      var sum = 0;
      var list = [1, 2, 3, 4, 5];
      for (var i = 0; i < list.length; i++) {
        sum += list[i];
      }
      console.log("加總結果: ", sum);

      console.warn('----我是分隔線----');

      /**
       * 使用 reduce 變可簡單做到, sum 每次進來為上次 return 的結果
       * item 則為每次進來的項目
       */
      var result = list.reduce(function(sum, item) {
        return sum += item;
      });
      console.log("加總結果: ", result);

      var list1 = [3, 6, 9, 12, 15, 18, 21, 24, 27, 30];
      var result1 = list1.reduce(function(sum, item) {
        return sum += item;
      });
      console.log(result1);

      // carList 有5台車子，每台車子有車齡還有車牌
      // 請加總所有車齡，得出一個數字
      var carList = [
        { name: 'toyota', age: 10 },
        { name: 'missan', age: 15 },
        { name: 'honda', age: 17 },
        { name: 'ford', age: 21 },
        { name: 'mitsubishi', age: 19 },
      ];
      var result1 = carList.reduce(function(sum, car) {
        return sum += car.age;
      }, 0);
      console.log(result1);
      //在初始值上加個0 答案被我誤打誤撞就出來了 但不知為什麼
      /**
       * 原因是：因為如果沒給初始值，那初始值會被黑認為「第一個項目」
       * 也就是 { name: 'toyota', age: 10 } 這個 Object
       * 之後 reduce 再把 age 一個個加進來，看起來像是：
       * { name: 'toyota', age: 10 } + 15 + 17 + 21 + 19
       *     ↑ 這傢伙是物件 跟後面的東西相加會變字串
       * [object Object]15172119 ← 就會全部串在一起了!
       對 我一開始做 沒放初始值 就一直印出這個結果
       */

      /**
       * 再一題：找出最大值
       */
      function rand() { return ~~(Math.random() * 100) }
      var list = Array(10).fill(null).map(function() { return rand()});
      console.warn("清單是一個隨機數字陣列，請使用 reduce 找出最大值");
      console.log(list);
      var result2 = list.reduce(function(max, item) {
        return Math.max(max, item);
      });
      console.log(result2);

      /**
       * 再再一題：
       * 繼上題的list，請加總所有超過40的數字
       */
       var result3 = list.reduce(function(sum, item) {
         // if (item > 40) {
         //   return sum + item;
         // }
         // else {
         //   return sum;
         // }

         return item > 40 ? sum + item: sum;
         // return sum + (item > 40 && item);
       }, 0);
       console.log(result3);
       /**
       找出 list 裡的所有奇數
       */
       list.reduce(function(single, item) {
         return item % 2 ? console.log(item): "";
       }, 0);

       // 這邊有一個觀念很重要， reduce 是要回傳一個結果用的
       // 也就是 var XXX = list.reduce(....)
       // 希望是回傳一個陣列，而不是直接把每個奇數印出來,
       // 按照這次的寫法，你會把 console.log 給下次的 single
       // 但是 console.log 並不會回傳東西。
       // 所以你的 single 其實都沒用到，即使初始值一開始給 0
       // 也沒用到。
       // 答案我直接寫在下面：
       var result4 = list.reduce(function(ans, item) {
         if(item % 2) {
           ans.push(item);
         }
         return ans;
       }, []);
       console.log("找到的奇數為：", result4);

       // 再來一題：
       // 清單裡有奇數有偶數，希望遇到奇數就減去，遇到偶數就加，意即
       // [1, 2, 3, 4] => -1 +2 -3 +4 => 2
       // 請直接使用 list 變數。
       // 請注意 ans 一開始就是預設值，之後每次進來是上次 return 的結果
       var result5 = list.reduce(function(ans, item) {
         // ...
       }, 0);
        console.log("最後加總的結果是：", result5);
    </script>
  </body>
</html>
